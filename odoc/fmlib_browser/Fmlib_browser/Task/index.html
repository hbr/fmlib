<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Task (fmlib_browser.Fmlib_browser.Task)</title><meta charset="utf-8"/><link rel="stylesheet" href="../../../odoc.support/odoc.css"/><meta name="generator" content="odoc 3.1.0"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../odoc.support/highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../../../index.html">Index</a> &#x00BB; <a href="../../index.html">fmlib_browser</a> &#x00BB; <a href="../index.html">Fmlib_browser</a> &#x00BB; Task</nav><header class="odoc-preamble"><h1>Module <code><span>Fmlib_browser.Task</span></code></h1><p>Tasks to be performed within <a href="../Command/index.html" title="Command">Commands</a></p></header><div class="odoc-tocs"><nav class="odoc-toc odoc-local-toc"><ul><li><a href="#error-types">Error types</a></li><li><a href="#basic-type-and-functions">Basic type and functions</a></li><li><a href="#write-to-the-console">Write to the console</a></li><li><a href="#messages-to-the-javascript-world">Messages to the javascript world</a></li><li><a href="#focus-and-blur-elements">Focus and blur elements</a></li><li><a href="#defer-tasks-a-certain-time">Defer tasks a certain time</a></li><li><a href="#time-and-time-zone">Time and time zone</a></li><li><a href="#random-values">Random values</a></li><li><a href="#navigation">Navigation</a></li><li><a href="#file-operations">File operations</a></li><li><a href="#http-requests">Http requests</a></li></ul></nav></div><div class="odoc-content"><h2 id="error-types"><a href="#error-types" class="anchor"></a>Error types</h2><div class="odoc-spec"><div class="spec type anchored" id="type-empty"><a href="#type-empty" class="anchor"></a><code><span><span class="keyword">type</span> empty</span><span> = </span><span>|</span></code></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-not_found"><a href="#type-not_found" class="anchor"></a><code><span><span class="keyword">type</span> not_found</span><span> = </span><span>[ </span></code><ol><li id="type-not_found.Not_found" class="def variant constructor anchored"><a href="#type-not_found.Not_found" class="anchor"></a><code><span>| </span><span>`Not_found</span></code></li></ol><code><span> ]</span></code></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-read_failed"><a href="#type-read_failed" class="anchor"></a><code><span><span class="keyword">type</span> read_failed</span><span> = </span><span>[ </span></code><ol><li id="type-read_failed.Read_failed" class="def variant constructor anchored"><a href="#type-read_failed.Read_failed" class="anchor"></a><code><span>| </span><span>`Read_failed</span></code></li></ol><code><span> ]</span></code></div></div><h2 id="basic-type-and-functions"><a href="#basic-type-and-functions" class="anchor"></a>Basic type and functions</h2><div class="odoc-spec"><div class="spec type anchored" id="type-t"><a href="#type-t" class="anchor"></a><code><span><span class="keyword">type</span> <span>('a, +'e) t</span></span></code></div><div class="spec-doc"><p>Task succeeding with a value of type <code>'a</code> or failing with an error object of type <code>'e</code></p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-succeed"><a href="#val-succeed" class="anchor"></a><code><span><span class="keyword">val</span> succeed : <span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <span><span>(<span class="type-var">'a</span>, <span class="type-var">'e</span>)</span> <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p><code>succeed a</code> Task which immediately succeeds with value <code>a</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-return"><a href="#val-return" class="anchor"></a><code><span><span class="keyword">val</span> return : <span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <span><span>(<span class="type-var">'a</span>, <span class="type-var">'e</span>)</span> <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p>Same as <a href="#val-succeed"><code>succeed</code></a>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-fail"><a href="#val-fail" class="anchor"></a><code><span><span class="keyword">val</span> fail : <span><span class="type-var">'e</span> <span class="arrow">&#45;&gt;</span></span> <span><span>(<span class="type-var">'a</span>, <span class="type-var">'e</span>)</span> <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p><code>fail e</code> Task which immediately fails with the error <code>e</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-result"><a href="#val-result" class="anchor"></a><code><span><span class="keyword">val</span> result : <span><span><span>(<span class="type-var">'a</span>, <span class="type-var">'e</span>)</span> <span class="xref-unresolved">Stdlib</span>.result</span> <span class="arrow">&#45;&gt;</span></span> <span><span>(<span class="type-var">'a</span>, <span class="type-var">'e</span>)</span> <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p><code>result res</code> Task which immediately succeeds or fails depending on <code>res</code></p><p>The effect of the function is described by the code</p><pre class="language-ocaml"><code>    match res with
    | Ok a    -&gt; succeed a
    | Error e -&gt; fail e</code></pre></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-(&gt;&gt;=)"><a href="#val-(&gt;&gt;=)" class="anchor"></a><code><span><span class="keyword">val</span> (&gt;&gt;=) : <span><span><span>(<span class="type-var">'a</span>, <span class="type-var">'e</span>)</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span>(<span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <span><span>(<span class="type-var">'b</span>, <span class="type-var">'e</span>)</span> <a href="#type-t">t</a></span>)</span> <span class="arrow">&#45;&gt;</span></span> <span><span>(<span class="type-var">'b</span>, <span class="type-var">'e</span>)</span> <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p><code>task &gt;&gt;= f</code></p><p>First execute <code>task</code>. If it fails then the function fails. If <code>task</code> succeeds with the result <code>a</code> then execute the task <code>f a</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-(let*)"><a href="#val-(let*)" class="anchor"></a><code><span><span class="keyword">val</span> (let*) : <span><span><span>(<span class="type-var">'a</span>, <span class="type-var">'e</span>)</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span>(<span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <span><span>(<span class="type-var">'b</span>, <span class="type-var">'e</span>)</span> <a href="#type-t">t</a></span>)</span> <span class="arrow">&#45;&gt;</span></span> <span><span>(<span class="type-var">'b</span>, <span class="type-var">'e</span>)</span> <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p>More convenient syntax for the monadic bind operator <a href="#val-(&gt;&gt;=)"><code>(&gt;&gt;=)</code></a>.</p><p>The code</p><pre class="language-ocaml"><code>    let* a = task in
    f a</code></pre><p>is equivalent to</p><pre class="language-ocaml"><code>    task &gt;&gt;= f</code></pre><p>With the <code>let*</code> operator it is more convenient to chain tasks.</p><pre class="language-ocaml"><code>    let* a = t1 in
    let* b = t2 a in
    let* c = t3 a b in
    ...
    return f a b c ...</code></pre></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-map"><a href="#val-map" class="anchor"></a><code><span><span class="keyword">val</span> map : <span><span>(<span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'b</span>)</span> <span class="arrow">&#45;&gt;</span></span> <span><span><span>(<span class="type-var">'a</span>, <span class="type-var">'e</span>)</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span>(<span class="type-var">'b</span>, <span class="type-var">'e</span>)</span> <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p><code>map f task</code> Map the success result of <code>task</code> via the function <code>f</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-make_succeed"><a href="#val-make_succeed" class="anchor"></a><code><span><span class="keyword">val</span> make_succeed : 
  <span><span>(<span><span><span>(<span class="type-var">'a</span>, <span class="type-var">'e</span>)</span> <span class="xref-unresolved">Stdlib</span>.result</span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'b</span>)</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span>(<span class="type-var">'a</span>, <span class="type-var">'e</span>)</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span>(<span class="type-var">'b</span>, <a href="#type-empty">empty</a>)</span> <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p><code>make_succeed f task</code></p><p>Convert the task which might fail into a task which always succeeds by converting the positive or negative result via the function <code>f</code> into a new result.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-parallel"><a href="#val-parallel" class="anchor"></a><code><span><span class="keyword">val</span> parallel : 
  <span><span class="type-var">'accu</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span>(<span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'accu</span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'accu</span>)</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span><span>(<span class="type-var">'a</span>, <a href="#type-empty">empty</a>)</span> <a href="#type-t">t</a></span> list</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span>(<span class="type-var">'accu</span>, <a href="#type-empty">empty</a>)</span> <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p><code>parallel accu_start accumulate task_list</code></p><p>Run all the tasks in the task list in parallel. Collect the results of the individual tasks via the function <code>accumulate</code> into the accumulator. If all tasks of the list have finished, return the accumulator.</p><p>Note that the tasks of the list do not return errors. If they can have errors then <a href="#val-make_succeed"><code>make_succeed</code></a> can be used to encode the error into the result type <code>'a</code>.</p></div></div><h2 id="write-to-the-console"><a href="#write-to-the-console" class="anchor"></a>Write to the console</h2><div class="odoc-spec"><div class="spec value anchored" id="val-log_string"><a href="#val-log_string" class="anchor"></a><code><span><span class="keyword">val</span> log_string : <span>string <span class="arrow">&#45;&gt;</span></span> <span><span>(unit, <span class="type-var">'e</span>)</span> <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p><code>log_string str</code> Write <code>str</code> to the console.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-log_value"><a href="#val-log_value" class="anchor"></a><code><span><span class="keyword">val</span> log_value : <span><a href="../Value/index.html#type-t">Value.t</a> <span class="arrow">&#45;&gt;</span></span> <span><span>(unit, <span class="type-var">'e</span>)</span> <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p><code>log_value v</code> Write the javascript object <code>v</code> to the console.</p></div></div><h2 id="messages-to-the-javascript-world"><a href="#messages-to-the-javascript-world" class="anchor"></a>Messages to the javascript world</h2><div class="odoc-spec"><div class="spec value anchored" id="val-send_to_javascript"><a href="#val-send_to_javascript" class="anchor"></a><code><span><span class="keyword">val</span> send_to_javascript : <span><a href="../Value/index.html#type-t">Value.t</a> <span class="arrow">&#45;&gt;</span></span> <span><span>(unit, <span class="type-var">'e</span>)</span> <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p><code>send_to_javascript value</code> Send the javascript object <code>value</code> to the surrounding javascript world.</p></div></div><h2 id="focus-and-blur-elements"><a href="#focus-and-blur-elements" class="anchor"></a>Focus and blur elements</h2><div class="odoc-spec"><div class="spec value anchored" id="val-focus"><a href="#val-focus" class="anchor"></a><code><span><span class="keyword">val</span> focus : <span>string <span class="arrow">&#45;&gt;</span></span> <span><span>(unit, <a href="#type-not_found">not_found</a>)</span> <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p><code>focus id</code> Put the dom element with <code>id</code> into focus.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-blur"><a href="#val-blur" class="anchor"></a><code><span><span class="keyword">val</span> blur : <span>string <span class="arrow">&#45;&gt;</span></span> <span><span>(unit, <a href="#type-not_found">not_found</a>)</span> <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p><code>blur id</code> Unfocus the dom element with <code>id</code>.</p></div></div><h2 id="defer-tasks-a-certain-time"><a href="#defer-tasks-a-certain-time" class="anchor"></a>Defer tasks a certain time</h2><div class="odoc-spec"><div class="spec value anchored" id="val-sleep"><a href="#val-sleep" class="anchor"></a><code><span><span class="keyword">val</span> sleep : <span>int <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <span><span>(<span class="type-var">'a</span>, <span class="type-var">'e</span>)</span> <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p><code>sleep millis a</code> Sleep for <code>millis</code> milliseconds and then return <code>a</code>.</p><p>Examples:</p><pre class="language-ocaml"><code>    let* _ = sleep 1000 () in       (* sleep 1000 milliseconds *)
    task                            (* and then execute [task] *)

    let* a = task1 &gt;&gt;= sleep 1000   (* excute [task1] and return result
                                       [a] after 1000 milliseconds *)
    in
    task2 a                         (* then execute [task2 a] *)</code></pre></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-next_tick"><a href="#val-next_tick" class="anchor"></a><code><span><span class="keyword">val</span> next_tick : <span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <span><span>(<span class="type-var">'a</span>, <span class="type-var">'e</span>)</span> <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p><code>next_tick a</code> Return <code>a</code> in the next tick of the event loop.</p><p>Example: Execute <code>task</code> in the next round of the event loop.</p><pre class="language-ocaml"><code>    let* _ = next_tick () in
    task</code></pre></div></div><h2 id="time-and-time-zone"><a href="#time-and-time-zone" class="anchor"></a>Time and time zone</h2><div class="odoc-spec"><div class="spec value anchored" id="val-now"><a href="#val-now" class="anchor"></a><code><span><span class="keyword">val</span> now : <span><span>(<a href="../Time/index.html#type-t">Time.t</a>, <span class="type-var">'e</span>)</span> <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p>Get the current time.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-time_zone"><a href="#val-time_zone" class="anchor"></a><code><span><span class="keyword">val</span> time_zone : <span><span>(<a href="../Time/Zone/index.html#type-t">Time.Zone.t</a>, <span class="type-var">'e</span>)</span> <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p>Get the current time zone.</p></div></div><h2 id="random-values"><a href="#random-values" class="anchor"></a>Random values</h2><div class="odoc-spec"><div class="spec value anchored" id="val-random"><a href="#val-random" class="anchor"></a><code><span><span class="keyword">val</span> random : <span><span><span class="type-var">'a</span> <a href="../Random/index.html#type-t">Random.t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span>(<span class="type-var">'a</span>, <span class="type-var">'e</span>)</span> <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p><code>random ran</code> Execute the random generator <code>rand</code> and return the generated random value.</p></div></div><h2 id="navigation"><a href="#navigation" class="anchor"></a>Navigation</h2><div class="odoc-spec"><div class="spec value anchored" id="val-load"><a href="#val-load" class="anchor"></a><code><span><span class="keyword">val</span> load : <span>string <span class="arrow">&#45;&gt;</span></span> <span><span>(unit, <a href="#type-empty">empty</a>)</span> <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p><code>load url</code></p><p>Load the given <code>url</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-reload"><a href="#val-reload" class="anchor"></a><code><span><span class="keyword">val</span> reload : <span><span>(unit, <a href="#type-empty">empty</a>)</span> <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p>Reload the current page.</p></div></div><h2 id="file-operations"><a href="#file-operations" class="anchor"></a>File operations</h2><div class="odoc-spec"><div class="spec value anchored" id="val-select_file"><a href="#val-select_file" class="anchor"></a><code><span><span class="keyword">val</span> select_file : <span><span>string list</span> <span class="arrow">&#45;&gt;</span></span> <span><span>(<a href="../File/index.html#type-t">File.t</a>, <a href="#type-empty">empty</a>)</span> <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p><code>select_file media_types</code> Show the browser's file selection dialog and return a file when the user selected one. The given list of <code>media_types</code> allows restricting what file types are visible in the dialog (users can still select different file types if they want to).</p><p>NOTE: This task only works if it is triggered in reaction to a user event, such as a mouse click. This restriction is imposed by browsers for security reasons (websites should not be able to ask for file access without user interaction).</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-select_files"><a href="#val-select_files" class="anchor"></a><code><span><span class="keyword">val</span> select_files : <span><span>string list</span> <span class="arrow">&#45;&gt;</span></span> <span><span>(<span><a href="../File/index.html#type-t">File.t</a> list</span>, <a href="#type-empty">empty</a>)</span> <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p><code>select_files media_types</code> The same as <a href="#val-select_file"><code>select_file</code></a> but allows selecting multiple files at once.</p><p>NOTE: This task only works if it is triggered in reaction to a user event, such as a mouse click. This restriction is imposed by browsers for security reasons (websites should not be able to ask for file access without user interaction).</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-file_text"><a href="#val-file_text" class="anchor"></a><code><span><span class="keyword">val</span> file_text : <span><a href="../File/index.html#type-t">File.t</a> <span class="arrow">&#45;&gt;</span></span> <span><span>(string, <a href="#type-read_failed">read_failed</a>)</span> <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p><code>file_text file f</code></p><p>Read the contents of <code>file</code> into a string. Reading can fail, e.g. in case of missing filesystem permissions.</p></div></div><h2 id="http-requests"><a href="#http-requests" class="anchor"></a>Http requests</h2><div class="odoc-spec"><div class="spec value anchored" id="val-http_request"><a href="#val-http_request" class="anchor"></a><code><span><span class="keyword">val</span> http_request : 
  <span>string <span class="arrow">&#45;&gt;</span></span>
  <span>string <span class="arrow">&#45;&gt;</span></span>
  <span><span><span>(string * string)</span> list</span> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../Http/Body/index.html#type-t">Http.Body.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span class="type-var">'a</span> <a href="../Http/Expect/index.html#type-t">Http.Expect.t</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span>(<span class="type-var">'a</span>, <a href="../Http/index.html#type-error">Http.error</a>)</span> <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p><code>http_request method url headers body expect</code></p><p>Make an http <code>method</code> request to <code>url</code> with <code>headers</code> and <code>body</code>. <code>expect</code> specifies the expected response format.</p><p>This is the most general http request function. See also the more specific functions <code>http_text</code> and <code>http_json</code>.</p><p>Example:</p><pre class="language-ocaml"><code>    let user = Value.(record [| (&quot;username&quot;, string &quot;Bob&quot;) |]) in
    http_request &quot;PUT&quot; &quot;/users&quot; [] (Body.json user) (Expect.string)
    |&gt; Command.attempt (fun result -&gt;
        match result with
        | Ok _ -&gt;
            GotUserCreated
        | Error _ -&gt;
            GotError &quot;failed to create user&quot;)</code></pre></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-http_text"><a href="#val-http_text" class="anchor"></a><code><span><span class="keyword">val</span> http_text : 
  <span>string <span class="arrow">&#45;&gt;</span></span>
  <span>string <span class="arrow">&#45;&gt;</span></span>
  <span><span><span>(string * string)</span> list</span> <span class="arrow">&#45;&gt;</span></span>
  <span>string <span class="arrow">&#45;&gt;</span></span>
  <span><span>(string, <a href="../Http/index.html#type-error">Http.error</a>)</span> <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p><code>http_text method url headers body</code></p><p>Make an http <code>method</code> request to <code>url</code> with <code>headers</code> and a string as the <code>body</code>. Expect a string as the response.</p><p>Method is one of <code>GET, POST, DELETE, ... </code>.</p><p>The headers and the body can be empty. The <code>Content-Type</code> header is automatically set to <code>text/plain</code>.</p><p>Example:</p><pre class="language-ocaml"><code>    http_text &quot;PUT&quot; &quot;/users&quot; [] &quot;Bob&quot;
    |&gt; Command.attempt (fun result -&gt;
        match result with
        | Ok _ -&gt;
            GotUserCreated
        | Error _ -&gt;
            GotError &quot;failed to create user&quot;)</code></pre></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-http_json"><a href="#val-http_json" class="anchor"></a><code><span><span class="keyword">val</span> http_json : 
  <span>string <span class="arrow">&#45;&gt;</span></span>
  <span>string <span class="arrow">&#45;&gt;</span></span>
  <span><span><span>(string * string)</span> list</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span><a href="../Value/index.html#type-t">Value.t</a> option</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span class="type-var">'a</span> <a href="../Decoder/index.html#type-t">Decoder.t</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span>(<span class="type-var">'a</span>, <a href="../Http/index.html#type-error">Http.error</a>)</span> <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p><code>http_json method url headers body decoder</code></p><p>Make an http <code>method</code> request to <code>url</code> with <code>headers</code> and an optional json value as the <code>body</code>. Expect a json value as the response which will be decoded by <code>decoder</code>.</p><p>The <code>headers</code> can be empty. The <code>Content-Type</code> header is automatically set to <code>application/json</code> if <code>body</code> is not <code>None</code>.</p><p>Example:</p><pre class="language-ocaml"><code>    let decoder = Decoder.array Decoder.string in
    http_json &quot;GET&quot; &quot;/users&quot; [] None decoder
    |&gt; Command.attempt (fun result -&gt;
        match result with
        | Ok usernames -&gt; (* the usernames were successfully decoded
                             into a string array *)
            GotUsers (Array.to_list usernames)
        | Error _ -&gt;
            GotError &quot;failed to obtain users&quot;)</code></pre></div></div></div></body></html>
