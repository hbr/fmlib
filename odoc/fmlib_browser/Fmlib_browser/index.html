<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Fmlib_browser (fmlib_browser.Fmlib_browser)</title><meta charset="utf-8"/><link rel="stylesheet" href="../../odoc.support/odoc.css"/><meta name="generator" content="odoc 3.1.0"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../odoc.support/highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../../index.html">Index</a> &#x00BB; <a href="../index.html">fmlib_browser</a> &#x00BB; Fmlib_browser</nav><header class="odoc-preamble"><h1>Module <code><span>Fmlib_browser</span></code></h1><p>Web Applications Running in the Browser</p><p>This library helps to write web applications which run in the browser. See some simple <a href="https://hbr.github.io/fmlib/webapp/index.html">live examples</a> and their <a href="https://github.com/hbr/fmlib/tree/master/src/examples/browser/webapp.ml">source code</a>.</p><p>For a step by step introduction see <a href="../doc.html" title="doc">&quot;Introduction to Web Applications&quot;</a>.</p></header><div class="odoc-tocs"><nav class="odoc-toc odoc-local-toc"><ul><li><a href="#utilities">Utilities</a></li><li><a href="#navigation">Navigation</a></li><li><a href="#encode-and-decode-javascript-values">Encode and Decode Javascript Values</a></li><li><a href="#http">Http</a></li><li><a href="#virtual-dom">Virtual Dom</a></li><li><a href="#commands-and-subscriptions">Commands and Subscriptions</a></li><li><a href="#debugging">Debugging</a></li><li><a href="#sandbox-applications">Sandbox Applications</a></li><li><a href="#full-web-application">Full Web Application</a></li><li><a href="#basic-web-application">Basic Web Application</a></li><li><a href="#element-application">Element Application</a></li></ul></nav></div><div class="odoc-content"><h2 id="utilities"><a href="#utilities" class="anchor"></a>Utilities</h2><div class="odoc-spec"><div class="spec module anchored" id="module-Random"><a href="#module-Random" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Random/index.html">Random</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>Generate Random Numbers</p></div></div><div class="odoc-spec"><div class="spec module anchored" id="module-Time"><a href="#module-Time" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Time/index.html">Time</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>Posix Time</p></div></div><div class="odoc-spec"><div class="spec module anchored" id="module-File"><a href="#module-File" class="anchor"></a><code><span><span class="keyword">module</span> <a href="File/index.html">File</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>A file handle that represents a user-selected file in the local filesystem. See <a href="Command/index.html#val-select_file"><code>Command.select_file</code></a> and <a href="Command/index.html#val-select_files"><code>Command.select_files</code></a> on how to obtain file handles.</p></div></div><div class="odoc-spec"><div class="spec module anchored" id="module-Event_flag"><a href="#module-Event_flag" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Event_flag/index.html">Event_flag</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>Event flags to stop propagation and prevent default action.</p></div></div><div class="odoc-spec"><div class="spec module anchored" id="module-Url"><a href="#module-Url" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Url/index.html">Url</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>Construct and parse URLs.</p></div></div><h2 id="navigation"><a href="#navigation" class="anchor"></a>Navigation</h2><div class="odoc-spec"><div class="spec module anchored" id="module-Navigation"><a href="#module-Navigation" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Navigation/index.html">Navigation</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div></div><h2 id="encode-and-decode-javascript-values"><a href="#encode-and-decode-javascript-values" class="anchor"></a>Encode and Decode Javascript Values</h2><div class="odoc-spec"><div class="spec module anchored" id="module-Value"><a href="#module-Value" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Value/index.html">Value</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>Javascript Values</p></div></div><div class="odoc-spec"><div class="spec module anchored" id="module-Decoder"><a href="#module-Decoder" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Decoder/index.html">Decoder</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div></div><h2 id="http"><a href="#http" class="anchor"></a>Http</h2><div class="odoc-spec"><div class="spec module anchored" id="module-Http"><a href="#module-Http" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Http/index.html">Http</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>Data of an Http Request.</p></div></div><h2 id="virtual-dom"><a href="#virtual-dom" class="anchor"></a>Virtual Dom</h2><div class="odoc-spec"><div class="spec module anchored" id="module-Attribute"><a href="#module-Attribute" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Attribute/index.html">Attribute</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div></div><div class="odoc-spec"><div class="spec module anchored" id="module-Html"><a href="#module-Html" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Html/index.html">Html</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>Virtual Dom</p></div></div><h2 id="commands-and-subscriptions"><a href="#commands-and-subscriptions" class="anchor"></a>Commands and Subscriptions</h2><div class="odoc-spec"><div class="spec module anchored" id="module-Task"><a href="#module-Task" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Task/index.html">Task</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>Tasks to be performed within <a href="Command/index.html" title="Command">Commands</a></p></div></div><div class="odoc-spec"><div class="spec module anchored" id="module-Command"><a href="#module-Command" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Command/index.html">Command</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>Commands to be executed.</p></div></div><div class="odoc-spec"><div class="spec module anchored" id="module-Subscription"><a href="#module-Subscription" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Subscription/index.html">Subscription</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>Subscriptions to global events.</p></div></div><h2 id="debugging"><a href="#debugging" class="anchor"></a>Debugging</h2><div class="odoc-spec"><div class="spec value anchored" id="val-debug"><a href="#val-debug" class="anchor"></a><code><span><span class="keyword">val</span> debug : <span>string <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p><code>debug str</code> Log <code>str</code> to the console as a side effect.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-debug_value"><a href="#val-debug_value" class="anchor"></a><code><span><span class="keyword">val</span> debug_value : <span><a href="Value/index.html#type-t">Value.t</a> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p><code>debug_value v a</code> Log the javascript value <code>v</code> to the console as a side effect.</p></div></div><h2 id="sandbox-applications"><a href="#sandbox-applications" class="anchor"></a>Sandbox Applications</h2><p>A sandbox application has only limited user interactions. A sandbox application cannot execute commands. It can only get messages from user interactions like mouse clicks, keyboard strokes on elements in focus etc.</p><p>The dom of a sandbox application is put directly under the <code>body</code> of the html page i.e. it occupies the whole browser window.</p><div class="odoc-spec"><div class="spec value anchored" id="val-sandbox"><a href="#val-sandbox" class="anchor"></a><code><span><span class="keyword">val</span> sandbox : 
  <span><span class="type-var">'state</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span>(<span><span class="type-var">'state</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'msg</span> <a href="Html/index.html#type-t">Html.t</a></span>)</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span>(<span><span class="type-var">'state</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'msg</span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'state</span>)</span> <span class="arrow">&#45;&gt;</span></span>
  unit</span></code></div><div class="spec-doc"><p><code>sandbox state view update</code></p><p>A sandbox application is started with the command</p><pre class="language-ocaml"><code>    let _ = sandbox state view update</code></pre><p>and it needs only a very simple html file of the form</p><pre>    &lt;!-- file: index.html --&gt;
    &lt;!DOCTYPE html&gt;
    &lt;html&gt;
        &lt;head&gt;
            &lt;script type=&quot;text/javascript&quot; src=&quot;webapp.js&quot;&gt;
            &lt;/script&gt;
        &lt;/head&gt;
        &lt;body&gt;
        &lt;/body&gt;
    &lt;/html&gt;</pre><p>The application is started on the onload event of the browser window.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-sandbox_plus"><a href="#val-sandbox_plus" class="anchor"></a><code><span><span class="keyword">val</span> sandbox_plus : 
  <span><span class="type-var">'state</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span>(<span><span class="type-var">'state</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'msg</span> <a href="Html/index.html#type-t">Html.t</a></span>)</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span>(<span><span class="type-var">'state</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'msg</span> <a href="Subscription/index.html#type-t">Subscription.t</a></span>)</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span>(<span><span class="type-var">'state</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'msg</span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'state</span>)</span> <span class="arrow">&#45;&gt;</span></span>
  unit</span></code></div><div class="spec-doc"><p><code>sandbox_plus state view subs update</code></p><p>A <code>sandbox_plus</code> application is like a sandbox application. In addition it can subscribe to events.</p></div></div><h2 id="full-web-application"><a href="#full-web-application" class="anchor"></a>Full Web Application</h2><p>A full web application has full user interaction, can execute arbitrary commands and subscribe to all possible global events. It allows controlling the browser's title bar (through the return value of the <code>update</code> function) and the browser's address bar (see module <a href="Navigation/index.html"><code>Navigation</code></a> for more details).</p><div class="odoc-spec"><div class="spec value anchored" id="val-application"><a href="#val-application" class="anchor"></a><code><span><span class="keyword">val</span> application : 
  <span>string <span class="arrow">&#45;&gt;</span></span>
  <span><span>(<span><a href="Url/index.html#type-t">Url.t</a> <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'msg</span> <a href="Navigation/index.html#type-key">Navigation.key</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span>(<span class="type-var">'state</span> * <span><span class="type-var">'msg</span> <a href="Command/index.html#type-t">Command.t</a></span>)</span> <a href="Decoder/index.html#type-t">Decoder.t</a></span>)</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span>(<span><span class="type-var">'state</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'msg</span> <a href="Html/index.html#type-t">Html.t</a></span> * string)</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span>(<span><span class="type-var">'state</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'msg</span> <a href="Subscription/index.html#type-t">Subscription.t</a></span>)</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span>(<span><span class="type-var">'state</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'msg</span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'state</span> * <span><span class="type-var">'msg</span> <a href="Command/index.html#type-t">Command.t</a></span>)</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span>(<span><a href="Navigation/index.html#type-url_request">Navigation.url_request</a> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'msg</span>)</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span>(<span><a href="Url/index.html#type-t">Url.t</a> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'msg</span>)</span> <span class="arrow">&#45;&gt;</span></span>
  unit</span></code></div><div class="spec-doc"><p><code>application my_app init view subs update on_url_request on_url_change</code></p><p>Browser application named <code>my_app</code> on the javascript side. The application creates the global object named <code>my_app</code> which contains the two functions <code>init</code> and <code>post</code>.</p><p>The application is started on the javascript side with</p><pre>
    my_app.init ({
        data: &lt;initialisation object&gt;,
        onMessage: &lt;function to receive messages on the javascript side from
                    the application&gt;
    })</pre><p>The javascript code can post messages to the application by</p><pre>    my_app.post (message)</pre></div></div><h2 id="basic-web-application"><a href="#basic-web-application" class="anchor"></a>Basic Web Application</h2><div class="odoc-spec"><div class="spec value anchored" id="val-basic_application"><a href="#val-basic_application" class="anchor"></a><code><span><span class="keyword">val</span> basic_application : 
  <span><span class="type-var">'state</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span class="type-var">'msg</span> <a href="Command/index.html#type-t">Command.t</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span>(<span><span class="type-var">'state</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'msg</span> <a href="Html/index.html#type-t">Html.t</a></span> * string)</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span>(<span><span class="type-var">'state</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'msg</span> <a href="Subscription/index.html#type-t">Subscription.t</a></span>)</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span>(<span><span class="type-var">'state</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'msg</span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'state</span> * <span><span class="type-var">'msg</span> <a href="Command/index.html#type-t">Command.t</a></span>)</span> <span class="arrow">&#45;&gt;</span></span>
  unit</span></code></div><div class="spec-doc"><p><code>basic_application state command view subs update</code></p><p>A <a href="#val-basic_application"><code>basic_application</code></a> is like an <a href="#val-application"><code>application</code></a> with the following differences:</p><ul><li>it cannot interact with the surrounding javascript. I.e. it cannot receive initialization data, it cannot receive or send messages to/from the javscript world</li><li>it cannot use navigation commands such as <a href="Command/index.html#val-push_url" title="Command.push_url">push_url</a> or <a href="Command/index.html#val-back" title="Command.back">back</a></li></ul></div></div><h2 id="element-application"><a href="#element-application" class="anchor"></a>Element Application</h2><p>An element application is like <a href="#val-application"><code>application</code></a> above with the difference that the dom is inserted directly under a certain element of the dom tree. The web application generated by the library does not touch the dom outside the user chosen element.</p><p>Purpose of the element application: Use an already written webapplication in javascript and add certain functions written in ocaml by using this library.</p><p>The element application offers a smooth path to start using the library without rewriting an already existing application from scratch.</p><p>The javascript part and the ocaml part can communicate via message passing i.e. the javascript part can post a javascript object to ocaml (see <a href="Subscription/index.html#val-on_message"><code>Subscription.on_message</code></a>) and the ocaml part can send javascript objects (see <a href="Value/index.html"><code>Value</code></a> and <a href="Task/index.html#val-send_to_javascript"><code>Task.send_to_javascript</code></a>).</p><div class="odoc-spec"><div class="spec value anchored" id="val-element"><a href="#val-element" class="anchor"></a><code><span><span class="keyword">val</span> element : 
  <span>string <span class="arrow">&#45;&gt;</span></span>
  <span><span><span>(<span class="type-var">'state</span> * <span><span class="type-var">'msg</span> <a href="Command/index.html#type-t">Command.t</a></span>)</span> <a href="Decoder/index.html#type-t">Decoder.t</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span>(<span><span class="type-var">'state</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'msg</span> <a href="Html/index.html#type-t">Html.t</a></span>)</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span>(<span><span class="type-var">'state</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'msg</span> <a href="Subscription/index.html#type-t">Subscription.t</a></span>)</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span>(<span><span class="type-var">'state</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'msg</span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'state</span> * <span><span class="type-var">'msg</span> <a href="Command/index.html#type-t">Command.t</a></span>)</span> <span class="arrow">&#45;&gt;</span></span>
  unit</span></code></div><div class="spec-doc"><p><code>element my_app init view subs update</code></p><p>Browser application named <code>my_app</code> on the javascript side. The application creates the global object named <code>my_app</code> which contains the two functions <code>init</code> and <code>post</code>.</p><p>The application is started on the javascript side with</p><pre>
    my_app.init ({
        data: &lt;initialisation object&gt;,
        element_id: &lt;id of the element under which the application works&gt;,
        onMessage: &lt;function to receive messages on the javascript side from
                    the application&gt;
    })</pre><p>The javascript code can post messages to the application by</p><pre>    my_app.post (message)</pre></div></div></div></body></html>
