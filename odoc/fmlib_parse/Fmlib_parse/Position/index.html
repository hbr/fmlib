<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Position (fmlib_parse.Fmlib_parse.Position)</title><meta charset="utf-8"/><link rel="stylesheet" href="../../../odoc.support/odoc.css"/><meta name="generator" content="odoc 3.1.0"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../odoc.support/highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../../../index.html">Index</a> &#x00BB; <a href="../../index.html">fmlib_parse</a> &#x00BB; <a href="../index.html">Fmlib_parse</a> &#x00BB; Position</nav><header class="odoc-preamble"><h1>Module <code><span>Fmlib_parse.Position</span></code></h1><p>Represent a position in a text file.</p></header><div class="odoc-tocs"><nav class="odoc-toc odoc-local-toc"><ul><li><a href="#basics">Basics</a></li><li><a href="#line-and-column-number">Line and column number</a></li><li><a href="#byte-offsets">Byte offsets</a></li><li><a href="#increment-position">Increment position</a></li><li><a href="#compare-positions">Compare positions</a></li><li><a href="#ranges-(i.e.-pairs-of-positions)">Ranges (i.e. pairs of positions)</a></li></ul></nav></div><div class="odoc-content"><p>A position in a text file is represented by a line number and a column number, both starting with zero. So the first line is line number zero and the first column is column number zero.</p><p>Sometimes the absolute byte offset since the beginning of the file is important. Therefore the absolute byte offset for the last newline is included as well.</p><p>Furthermore it is important to distinguish between the byte position and the character position within a line. Therefore a correction offset is needed which is added to the byte column to get the character column.</p><p>An object of type <code>Position.t</code> has the following content:</p><ul><li>Byte offset from the beginning of the stream to the beginning of the previous line.</li></ul><ul><li>Number of the current line (zero based)</li></ul><ul><li>Byte position within the current line (zero based)</li></ul><ul><li>Correction between the byte position and the visible character position on the current line.</li></ul><p>By default all bytes between space and ascii 126 and between decimal 128 and decimal 255 are treated as one character. The tab character is treated as 4 characters and the newline character increments the line number and resets the column number. All other bytes between decimal 0 and before the space are treated as zero characters.</p><p>This default handling is done by the function <a href="#val-next"><code>next</code></a>. For more special treatments (e.g. unicode characters) there is the function <a href="#val-correct"><code>correct</code></a> to adapt the character position with respect to the by position and the functions <a href="#val-advance"><code>advance</code></a> and <a href="#val-newline"><code>newline</code></a> for find granular control of the position.</p><h2 id="basics"><a href="#basics" class="anchor"></a>Basics</h2><div class="odoc-spec"><div class="spec type anchored" id="type-t"><a href="#type-t" class="anchor"></a><code><span><span class="keyword">type</span> t</span></code></div><div class="spec-doc"><p>Position in a text file.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-start"><a href="#val-start" class="anchor"></a><code><span><span class="keyword">val</span> start : <a href="#type-t">t</a></span></code></div><div class="spec-doc"><p>Position with points to the start of a textfile (line = 0, column = 0).</p></div></div><h2 id="line-and-column-number"><a href="#line-and-column-number" class="anchor"></a>Line and column number</h2><div class="odoc-spec"><div class="spec value anchored" id="val-line"><a href="#val-line" class="anchor"></a><code><span><span class="keyword">val</span> line : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> int</span></code></div><div class="spec-doc"><p><code>line pos</code> The line number corresponding to the position <code>p</code>. Note: The first line is line 0.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-column"><a href="#val-column" class="anchor"></a><code><span><span class="keyword">val</span> column : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> int</span></code></div><div class="spec-doc"><p><code>column pos</code> The character position within the current line of <code>pos</code>.</p><p>For differences between <code>column</code> and <code>byte_column</code> see <a href="#val-byte_column"><code>byte_column</code></a>.</p><p>Note: The first column is column 0.</p></div></div><h2 id="byte-offsets"><a href="#byte-offsets" class="anchor"></a>Byte offsets</h2><div class="odoc-spec"><div class="spec value anchored" id="val-byte_offset_bol"><a href="#val-byte_offset_bol" class="anchor"></a><code><span><span class="keyword">val</span> byte_offset_bol : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> int</span></code></div><div class="spec-doc"><p><code>byte_offset_bol pos</code> The byte offset since the beginning of the file at the last newline.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-byte_column"><a href="#val-byte_column" class="anchor"></a><code><span><span class="keyword">val</span> byte_column : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> int</span></code></div><div class="spec-doc"><p><code>byte_column pos</code> The byte column number corresponding to the position <code>p</code>.</p><p>Note: If the line up to the position has only printable ascii or latin-1 characters, then the <code>byte_column p</code> is the same as <code>column p</code>. If the line has some multibyte unicode characters, then both columns might be different. Notprintable ascii characters i.e. characters before the space character increase the byte column, but not the column.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-byte_offset"><a href="#val-byte_offset" class="anchor"></a><code><span><span class="keyword">val</span> byte_offset : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> int</span></code></div><div class="spec-doc"><p><code>byte_offset pos</code> The byte offset of the current position since the beginning of the file.</p></div></div><h2 id="increment-position"><a href="#increment-position" class="anchor"></a>Increment position</h2><div class="odoc-spec"><div class="spec value anchored" id="val-next"><a href="#val-next" class="anchor"></a><code><span><span class="keyword">val</span> next : <span>char <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <a href="#type-t">t</a></span></code></div><div class="spec-doc"><p><code>next next_char pos</code>: Advance the position by using the next character. If the next character is a newline, then the line number is increment and the column number is reset to 0.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-correct"><a href="#val-correct" class="anchor"></a><code><span><span class="keyword">val</span> correct : <span>int <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <a href="#type-t">t</a></span></code></div><div class="spec-doc"><p><code>correct n pos</code> Correct the column by <code>n</code>. In case of multibyte characters like unicode characters the correction must be negative.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-advance"><a href="#val-advance" class="anchor"></a><code><span><span class="keyword">val</span> advance : <span>int <span class="arrow">&#45;&gt;</span></span> <span>int <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <a href="#type-t">t</a></span></code></div><div class="spec-doc"><p><code>advance byte_width width pos</code> Advance the position by <code>byte_width</code> and character width <code>width</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-newline"><a href="#val-newline" class="anchor"></a><code><span><span class="keyword">val</span> newline : <span>int <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <a href="#type-t">t</a></span></code></div><div class="spec-doc"><p><code>newline byte_width pos</code> Start a new line i.e. set the character position and byte position to zero and increment the line number.</p></div></div><h2 id="compare-positions"><a href="#compare-positions" class="anchor"></a>Compare positions</h2><div class="odoc-spec"><div class="spec value anchored" id="val-is_less_equal"><a href="#val-is_less_equal" class="anchor"></a><code><span><span class="keyword">val</span> is_less_equal : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> bool</span></code></div><div class="spec-doc"><p><code>is_less_equal p1 p2</code> Are <code>p1</code> and <code>p2</code> in the correct order i.e. <code>p2</code> is not before <code>p1</code>.</p></div></div><h2 id="ranges-(i.e.-pairs-of-positions)"><a href="#ranges-(i.e.-pairs-of-positions)" class="anchor"></a>Ranges (i.e. pairs of positions)</h2><div class="odoc-spec"><div class="spec type anchored" id="type-range"><a href="#type-range" class="anchor"></a><code><span><span class="keyword">type</span> range</span><span> = <a href="#type-t">t</a> * <a href="#type-t">t</a></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-is_valid_range"><a href="#val-is_valid_range" class="anchor"></a><code><span><span class="keyword">val</span> is_valid_range : <span><a href="#type-range">range</a> <span class="arrow">&#45;&gt;</span></span> bool</span></code></div><div class="spec-doc"><p>Is the range a valid range in a file i.e. are both positions valid and is the first position before or at the second position?</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-merge"><a href="#val-merge" class="anchor"></a><code><span><span class="keyword">val</span> merge : <span><a href="#type-range">range</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-range">range</a> <span class="arrow">&#45;&gt;</span></span> <a href="#type-range">range</a></span></code></div><div class="spec-doc"><p><code>merge range_1 range_2</code></p><p>Merge the ranges <code>range_1</code> and <code>range_2</code> the result range has the maximum span of both. I.e. the merges selects as start position the lowest position of both and as end position the highest position of both. I.e. the merges selects as start position the lowest position of both and as end position the highest position of both.</p></div></div></div></body></html>
